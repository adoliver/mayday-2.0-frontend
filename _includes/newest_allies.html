
<div class="row no-gutter">
  <div id="js-legislators" class="js-legislators newest-leaders"></div>
</div>

<script id="legislator_template" type="text/html">
{% raw %}

    <div class="col-md-4 col-sm-8 col-xs-11 bottom-margin new-legislator">
      <div class="col-md-4 col-sm-3 col-xs-4">
        <a href="/legislator/?bioguide_id={{bioguide_id}}">
          <div class="background-square" style="background-image:url('{{image_url}}')"></div>
        </a>
      </div>
      <div class="col-md-8 col-sm-6 col-xs-8">
        <h3 class="no-top-margin">{{ short_title }} <strong>{{ name }}</strong></h3>
        <h4> {{ party }}-{{ state_abbrev }} {{display_district}}</h4>
        <a class="btn btn-targets story-grey" href="/legislator/?bioguide_id={{bioguide_id}}">Read More</a>
      </div>
    </div>

{% endraw %}
</script>
<script>
(function ( data ){
  $(document).ready(function(){

    "use strict";

    var newAllieData = data;
    var outSide = {};

    function renderAllies(legislator_data, index) {

      var rendered = [];
      legislator_data.short_title = legislator_data.title === 'Senator' ? 'Sen.' : 'Rep.';
      rendered = ich.legislator_template(legislator_data);
      $('#js-legislators').append(rendered);
    }

    function callDataAndTemplate(legislators) {
      var allyObject = [];

      legislators.forEach( function ( data, index ){ //gets three reps
        if (index < 3 ){
          allyObject.push( data );
        }
      });
      allyObject.map(renderAllies);
    }

    $.getJSON(newAllieData, callDataAndTemplate);

  });

})( '{{site.services_url}}/legislators/newest_supporters.json' );

</script>